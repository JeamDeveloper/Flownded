<!DOCTYPE html>
<html>
<head>
  <title>Text Encryption/Decryption</title>
  <style>
    textarea {
      resize: vertical;
    }
  </style>
  <script>
    function adjustTextAreaHeight(textArea) {
      textArea.style.height = "auto";
      textArea.style.height = textArea.scrollHeight + "px";
    }

    function decryptText() {
      var encryptedText = document.getElementById('encryptedText').value;
      var decryptedText = unescape(encryptedText.replace(/\\u/g, '%u'));
      try {
        decryptedText = JSON.stringify(JSON.parse(decryptedText), null, 2);
      } catch (error) {
        // No es un JSON válido, no se realiza ninguna transformación adicional
      }
      var decryptedTextArea = document.getElementById('decryptedText');
      decryptedTextArea.value = decryptedText;
      adjustTextAreaHeight(decryptedTextArea);
    }

    function copyResult() {
      var decryptedText = document.getElementById('decryptedText');
      decryptedText.select();
      document.execCommand('copy');
      alert('Texto copiado al portapapeles: ' + decryptedText.value);
    }

    function fixJsonStructure() {
      var jsonText = document.getElementById('jsonText').value;
      var formattedJson = '';
      try {
        formattedJson = JSON.stringify(JSON.parse(jsonText), null, 2);
      } catch (error) {
        // No es un JSON válido, no se realiza ninguna transformación adicional
      }
      var formattedTextArea = document.getElementById('formattedJson');
      formattedTextArea.value = formattedJson;
      adjustTextAreaHeight(formattedTextArea);
    }

    function copyFormattedJson() {
      var formattedJson = document.getElementById('formattedJson');
      formattedJson.select();
      document.execCommand('copy');
      alert('Texto copiado al portapapeles: ' + formattedJson.value);
    }
  </script>
</head>
<body>
  <h1>Text Encryption/Decryption</h1>
  <label for="encryptedText">Ingresa el texto:</label>
  <br>
  <input type="text" id="encryptedText">
  <button onclick="decryptText()">Descifrar</button>
  <br>
  <label for="decryptedText">Texto descifrado:</label>
  <br>
  <textarea id="decryptedText" rows="4" cols="50" readonly></textarea>
  <br>
  <button onclick="copyResult()">Copiar resultado</button>

  <hr>

  <h2>Corregir estructura JSON</h2>
  <label for="jsonText">Ingresa el código JSON:</label>
  <br>
  <textarea id="jsonText" rows="4" cols="50"></textarea>
  <button onclick="fixJsonStructure()">Corregir estructura</button>
  <br>
  <label for="formattedJson">JSON corregido:</label>
  <br>
  <textarea id="formattedJson" rows="4" cols="50" readonly></textarea>
  <br>
  <button onclick="copyFormattedJson()">Copiar JSON corregido</button>

  <script>
    // Código adicional si es necesario
  </script>
</body>
</html>
