<!DOCTYPE html>
<html>
<head>
    <title>Detección de Key de Autotune</title>
    <script src="https://cdn.jsdelivr.net/npm/tone@14"></script>
</head>
<body>
    <form id="upload-form">
        <input type="file" id="music-file" accept=".mp3,.wav">
        <button type="button" onclick="detectKey()">Detectar Key</button>
    </form>
    <div id="result"></div>

    <script>
        async function detectKey() {
            const fileInput = document.getElementById('music-file');
            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onload = async function(event) {
                const arrayBuffer = event.target.result;
                const audioBuffer = await Tone.context.decodeAudioData(arrayBuffer);
                const key = detectKeyUsingToneJS(audioBuffer);
                displayResult(key);
            };

            reader.readAsArrayBuffer(file);
        }

        function detectKeyUsingToneJS(audioBuffer) {
            // Aquí irá el código para analizar el audio y detectar la key usando Tone.js
            // Ejemplo de detección ficticia para demostración:
            const keyOptions = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
            const randomIndex = Math.floor(Math.random() * keyOptions.length);
            return keyOptions[randomIndex];
        }

        function displayResult(key) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerText = `La Key detectada es: ${key}`;
        }
    </script>
</body>
</html>
